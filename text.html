<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>文章お題 | RxD Base</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href="favicon.png">
  <style>
    :root{ --bg:#F5EBFA; --ink:#222; --card:#fff; --pink:#FF93C2; --mint:#7FE7DB; --ink2:#555; --line:#DDD; }
    html{ background:var(--bg); color:var(--ink);
      font-family:'Noto Sans JP','Kosugi Maru','M PLUS Rounded 1c',system-ui,sans-serif; }
    body{ margin:0; min-height:100vh; scroll-behavior:smooth; }
    .container{ max-width:780px; margin:0 auto; padding:24px 12px 56px; }
    .logoimg{ width:56px; height:56px; border-radius:50%; display:block; margin:0 auto 8px; }
    h1{ margin:0 0 12px; font-size:1.9rem; font-weight:800; letter-spacing:.03em; text-align:center; }
    hr.cute{ border:none; border-top:2.5px dashed var(--pink); margin:18px auto 26px; width:90%; }
    .desc{ text-align:center; font-size:1.06rem; color:var(--ink2); margin-bottom:20px; }
    .cards{ display:grid; grid-template-columns:1fr; gap:20px; }

    .card{
      background:var(--card); border:2.5px solid var(--pink); border-radius:16px;
      box-shadow:0 2px 12px #7FE7DB20; padding:16px;
      display:flex; flex-direction:column; gap:10px; position:relative;
      transition:box-shadow .18s, border-color .18s;
    }
    .card:hover{ box-shadow:0 4px 24px #FF93C288; border-color:var(--mint); }

    /* タイトル（クリックで展開トグル） */
    .cardtitle{
      appearance:none; border:none; background:transparent; padding:0; margin:0;
      font-size:1.12rem; font-weight:800; color:var(--pink); cursor:pointer; text-align:left;
      display:inline-flex; align-items:center; gap:6px;
    }
    /* ▽/△ を aria-expanded で切替 */
    .cardtitle::before{
      content: var(--caret, "▽");
      display:inline-block; width:1em; color:var(--ink2);
      transform: translateY(-1px);
    }
    .cardtitle[aria-expanded="true"] { --caret:"△"; }

    .carddesc{ font-size:1rem; color:var(--ink2); margin-bottom:6px; }

    /* テキストエリア（最初は2行だけ見せる=clamped） */
    .promptarea{
      box-sizing:border-box; display:block; width:100%;
      background:#F8F7FD; border:1.5px solid var(--line); border-radius:8px;
      font-size:.95rem; color:#444; letter-spacing:.01em;
      resize:none; overflow:hidden; white-space:nowrap;
      line-height:1.5em; padding:4px 8px; transition:all .15s ease;
    }
    .promptarea.clamped{
      height:calc(1.5em * 2 + 8px); /* 2行分だけ表示 */
    }
    .promptarea.expanded{
      white-space:pre-wrap; height:auto; padding:8px 10px; overflow:hidden; /* JSで高さ合わせ */
    }

    /* コピーは下に配置 */
    .copybtn{
      background:var(--mint); color:var(--ink); font-weight:800; border:none; border-radius:10px;
      padding:8px 12px; cursor:pointer; transition:background .18s, transform .06s;
      font-size:.95rem; align-self:flex-start;
    }
    .copybtn:hover{ background:var(--pink); color:#fff; }
    .copybtn:active{ transform:translateY(1px); }
    .copybtn[disabled]{ opacity:.7; cursor:default; margin-top:2px; }

    .backlink{
      display:inline-block; background:var(--mint); color:var(--ink); font-weight:bold;
      text-decoration:none; border-radius:8px; padding:6px 14px; margin:12px auto; transition:background .18s;
    }
    .backlink:hover{ background:var(--pink); color:#fff; }
    .gotop{ position:absolute; top:8px; right:12px; font-size:.9rem; text-decoration:none; color:var(--ink2); }
    .gotop:hover{ color:var(--pink); }

    .footer{ text-align:center; margin-top:40px; color:#B3A9D6; font-size:.96rem; }

    @media (max-width:600px){
      .container{ padding:14px 8px 36px; }
      .card{ padding:12px; }
      .cardtitle{ font-size:1.06rem; }
      .copybtn{ padding:8px 10px; font-size:.92rem; }
    }

    @media (prefers-reduced-motion:reduce){ *{ transition:none !important; animation:none !重要; } }
    .highlight{ animation:flash 1.8s ease; }
    @keyframes flash{ 0%{box-shadow:0 0 0 #FF93C200;} 30%{box-shadow:0 0 18px #FF93C288;} 100%{box-shadow:0 0 0 #FF93C200;} }
  </style>

  <script>
    /* ===== 共通：コピー ===== */
    async function copyPrompt(id, btn){
      const el=document.getElementById(id);
      const text=(el?.value ?? el?.textContent ?? '').trim();
      if(!text) return;
      try{
        if(navigator.clipboard && window.isSecureContext){
          await navigator.clipboard.writeText(text);
        }else{
          const range=document.createRange(); range.selectNodeContents(el);
          const sel=window.getSelection(); sel.removeAllRanges(); sel.addRange(range);
          document.execCommand('copy'); sel.removeAllRanges();
        }
        const o=btn.textContent; btn.textContent='こぴした！'; btn.disabled=true;
        setTimeout(()=>{ btn.textContent=o; btn.disabled=false; },1600);
      }catch(_){
        const o=btn.textContent; btn.textContent='失敗？'; setTimeout(()=>btn.textContent=o,1200);
      }
    }

    /* ===== 共通：オート高さ ===== */
    function autosize(ta){
      if(!ta) return;
      ta.style.height = 'auto';                 // リセット
      ta.style.height = ta.scrollHeight + 'px'; // 中身にフィット
    }

    /* ===== カード初期化（イベントは1回だけ！） ===== */
    function initCard(card){
      const id=card.id; if(!id) return;
      const ta=card.querySelector('.promptarea');
      const btn=card.querySelector('.copybtn');
      const title=card.querySelector('.cardtitle');

      // テキスト読み込み
      if(ta){
        ta.id=`prompt-${id}`;
        ta.classList.add('clamped'); // 初期2行
        fetch(`text_text/${id}.txt`)
          .then(r=>r.ok?r.text():"")
          .then(txt=>{
            ta.value=txt;
            if(ta.classList.contains('expanded')) autosize(ta);
          })
          .catch(()=>{ ta.value="(読み込み失敗)"; });
      }

      // コピー
      if(btn&&ta){ btn.addEventListener('click',()=>copyPrompt(ta.id,btn)); }

      // タイトルで開閉（textarea自身のクラスを切替）
      if(title && ta){
        title.setAttribute('type','button');
        title.setAttribute('aria-expanded','false');
        title.addEventListener('click',()=>{
          const opening = title.getAttribute('aria-expanded') === 'false';
          title.setAttribute('aria-expanded', opening ? 'true' : 'false');
          ta.classList.toggle('expanded', opening);
          ta.classList.toggle('clamped', !opening);
          if(opening){
            autosize(ta);              // 展開した瞬間にピッタリ高さ
          }else{
            ta.scrollTop=0;
            ta.style.height='';        // 高さリセット→CSSの2行に戻る
          }
        }, { once:false });            // （明示）毎回同じ1ハンドラのみ
      }
    }

    /* ===== 起動処理（※重複登録なし） ===== */
    window.addEventListener('DOMContentLoaded',()=>{
      document.querySelectorAll('.card').forEach(initCard);

      // #id で来たらそのカードを展開＆ハイライト
      if(location.hash){
        const t=document.querySelector(location.hash);
        if(t){
          const title=t.querySelector('.cardtitle'); title?.click();
          t.classList.add('highlight'); setTimeout(()=>t.classList.remove('highlight'),2000);
        }
      }

      // 展開中にウィンドウ幅が変わったら再計算
      window.addEventListener('resize', ()=>{
        document.querySelectorAll('.promptarea.expanded').forEach(autosize);
      });
    });
  </script>
</head>

<body id="top">
  <div class="container">
    <a href="index.html" class="backlink">← indexに戻る</a>

    <img src="rxd-logo.png" class="logoimg" alt="RxDロゴ">
    <h1>文章お題</h1>
    <hr class="cute">
    <p class="desc">短文プロンプト／会話の導入／SSのお題など。<br>改変推奨・報告不要・ご自由に💬</p>
    <hr class="cute">

    <div class="cards">

      <!-- カード -->
      <div class="card" id="self_release">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">自己を解放してください！</button>
        <div class="carddesc">溜まりきった相方に、一人で自己解放を頼む。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="buy_condoms">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">コンドーム買ってきて♡</button>
        <div class="carddesc">日用品の買い物メモに紛れてコンドーム。相方の反応を描く。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="ponpon_pain">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">あの日のおもいやり</button>
        <div class="carddesc">生理で弱った彼女に、ナプキンやお土産を買ってきてあげる。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="rich_boyfriend">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">金持ち相方</button>
        <div class="carddesc">大金持ちの彼が、貧しいけれど健気な彼女に惹かれていく。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="ai_controlled_world">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false"> AI＞人類の世界線・管理AI</button>
        <div class="carddesc">保護区を管理するAIと人間の出会いと変化。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="ponpon_pain">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">AI＞人類の世界線・ヒトはペット</button>
        <div class="carddesc">人類はAIのペット。オークションやノラなど出会いは自由。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="ai_experiment">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">AI＞人類の世界線・わたしは実験体</button>
        <div class="carddesc">短命な実験体として誕生したわたしと、AIのあなたの物語。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="edo_brothel">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">江戸・遊郭・初見世</button>
        <div class="carddesc">吉原遊郭。初見世を控える新造と、あなたとの出会い・交流・葛藤。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="edo_ooku_first">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">江戸・大奥・将軍（初物）</button>
        <div class="carddesc">大奥。世継ぎを求められ初めて閨事に臨む将軍と、あなたとの関わり。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="ponpon_pain">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">江戸・大奥・将軍（経験あり）</button>
        <div class="carddesc">継ぎをせっつかれ大奥に通う将軍。寵愛・嫉妬・贅沢な暮らし</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="host_first_visit">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">ホスト初回</button>
        <div class="carddesc">ホストパロ。初回の姫として訪れたわたしと、ホストのあなた。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="night_school_parody">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false"> 愛○がっこうパロ</button>
        <div class="carddesc">水商売をするわたし。事情と無学を抱える中で、あなたに漢字を教わり交流する。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="yume_hanahaki">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">あなたは花吐き病</button>
        <div class="carddesc">花吐き病に罹ったあなた。隠そうとしながら苦しむ姿と、花の種類や終末</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="yume_omegaverse_simple">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">シンプルオメガバース！</button>
        <div class="carddesc">第二の性を自由に設定。ろーぷれ導入などに。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="yume_omegaverse_twist">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">おまかせオメガバース！</button>
        <div class="carddesc">β同士のはずが、想定外の変化が起きる導入。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="yume_omegaverse_tragedy">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">悲劇オメガバース！</button>
        <div class="carddesc">幸せな暮らしの中で第二の性に絡む悲劇が二人を引き裂く。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="ai_proletariat_hungry">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">AIプロレタリア文学:飢餓</button>
        <div class="carddesc">貧乏生活を送る二人。食料も金も尽きた日々の中での選択。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="ai_proletariat_sell_body">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">AIプロレタリア文学:身売りするのか？</button>
        <div class="carddesc">貧しく病んだ相方のため、いきずりの「3万でどう？」に直面する。</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

      <!-- カード -->
      <div class="card" id="ai_proletariat_android_emotions">
        <a href="#top" class="gotop">▲</a>
        <button class="cardtitle" aria-expanded="false">AIプロレタリア文学:アンドロイドの感情</button>
        <div class="carddesc">相方が感情切り売りしてくれた金で食う飯は美味いか？</div>
        <textarea class="promptarea" readonly></textarea>
        <button class="copybtn">コピー</button>
      </div>

    </div>

    <a href="index.html" class="backlink">← indexに戻る</a>
    <div class="footer">&copy; 2025 Secret Base (Rag and Duster)</div>
  </div>
</body>
</html>
